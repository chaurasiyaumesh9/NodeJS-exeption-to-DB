<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Rest API</title>
	<script type="text/javascript">
		
		function save(){
			var name = document.getElementById('name').value || null;
			var code = document.getElementById('code').value || null;
			var message = document.getElementById('message').value || null;
			var obj = {
				name: name,
				code:code,
				message: message
			};
			//console.log('obj : ',obj);
			AjaxCall(obj);
			clearForm();
			return false;
		}
		function AjaxCall( d ){
			var data = JSON.stringify({
			  "exception": {
			    "name": d.name,
			    "code": d.code,
			    "message": d.message
			  }
			});

			var xhr = new XMLHttpRequest();
			xhr.withCredentials = true;

			xhr.addEventListener("readystatechange", function () {
			  if (this.readyState === 4) {
			    console.log(this.responseText);
			    document.getElementById('successresults').innerHTML = "Exception record inserted successfully!";
			  }
			});

			xhr.open("POST", "https://meanstack-exceptiontodb.herokuapp.com/exceptions");
			//xhr.open("POST", "http://localhost:8010/exceptions");
			xhr.setRequestHeader("content-type", "application/json");
			xhr.setRequestHeader("cache-control", "no-cache");
			xhr.send(data);
		}
		function clearForm(){
			document.getElementById('name').value = "";
			document.getElementById('code').value = "";
			document.getElementById('message').value = "";
		}
	</script>
</head>
<body>
	<h2> Insert New Record </h2>
	<form action="#" id="frm_save" onsubmit="save();">
		<label for="name"> Name <input type="text" id="name"> </label><br/><br/>
		<label for="code"> Code <input type="text" id="code"> </label><br/><br/>
		<label for="message"> Message <input type="text" id="message">  </label><br/><br/>
		<input type="submit" value="Submit">
	</form><br/>
	<label id="successresults"></label>
</body>
</html>